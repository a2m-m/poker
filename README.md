# Poker Dealer App

ポーカーディーラー支援アプリのリポジトリです。要件や設計は `docs/` 配下にまとめています（ルールブックや仕様書など5点）。

## src構成方針

フロントエンドは Vite + React + TypeScript を想定し、画面エントリは `src/pages/`、再利用UIやレイアウトは `src/components/`、ドメインロジック・型定義・状態管理の土台は `src/domain/` に置く三層構造とします。各層間は props と型で疎結合に保ち、UIと計算ロジックを明確に分離します。

## かんたんセットアップ

Node.js 20 以降を推奨します（`npm` 同梱版でOK）。初回は依存関係のインストールのみで動作します。

```bash
npm install
npm run dev   # http://localhost:5173 で開発サーバー起動
npm run build # 型チェック込みの本番ビルド
```

品質チェックやプレビューは以下を使用します。

```bash
npm run lint       # ESLint（Prettier整形前提）
npm run test       # Vitest（jsdom環境）
npm run preview    # ビルド成果物の確認（http://localhost:4173/poker/）
```

## 1ハンド進行までの最短ルート

README だけで「起動→1ハンド進行」の流れを把握できるよう、最短の操作手順をまとめています。UIはモックを含みますが、セットアップしたプレイヤー情報はテーブルに反映され、手番や必要額が更新されるデモを確認できます。

1. `npm run dev` を実行し、ブラウザで `http://localhost:5173/` を開く。
2. ホーム画面で **「新規ゲームを開始」** を押してセットアップへ移動。
3. セットアップでプレイヤー名と初期スタックを調整し、SB/BB を入力。
   - 2人以上になると開始ボタンが有効化されます。
   - 追加は「末尾に追加」、席順調整は ↑↓ ボタン、削除は各行の「削除」。
4. 下部の **「テーブルを開く」** を押すと、入力した人数・ブラインドがテーブルに反映された状態でハンド#1が始まります。
5. テーブル画面では手番プレイヤー、コール必要額、最小レイズがステータスバーと各プレイヤーカードに表示されます。
   - 「アクションログを追加」（ActionModal内）でデモ用のログを積み、Undo で直前のログを巻き戻せます。
   - ブラウザをリロードしてもホームの **「前回を再開」** から同じハンドに戻れます（localStorage 保存）。
6. 次のハンド開始や配当表示は後続タスクで拡張予定です。現状は UI 骨組みと永続化の接続を確認するデモとして利用してください。

## デプロイ

`main` ブランチへの push をトリガーに、`.github/workflows/deploy.yml` がビルド成果物を GitHub Pages に自動デプロイします。ページはリポジトリ名に合わせて `/poker/` 配下に配置されるため、Vite の `base` も同じパスに設定しています。

### GitHub Pages 動作確認のポイント

- ローカルで `npm run build && npm run preview -- --host` を実行し、`http://localhost:4173/poker/#/table` などハッシュ付き URL で直接アクセス・リロードしても 404 にならないことを確認できます。
- セットアップからゲームを開始し、テーブルでリロード後に「前回を再開」が有効になることを確認すると、Pages 配信時の永続化（localStorage）も検証できます。
- iPad Safari での縦横回転やアドレスバーの表示/非表示による高さ揺れを抑えるため、`#root` は動的ビューポート（`100dvh`）を優先しています。

## ルーティング方針

GitHub Pages へのデプロイを想定し、サーバー側での 404 ハンドリングに依存しないよう `HashRouter` を採用しています。`/#/table` のようにハッシュ付きの URL になるため、直リンクやリロードでも安全に各ページへ遷移できます。
